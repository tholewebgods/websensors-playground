<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title></title>
</head>
<body>
<h1>Accelerometer</h1>
<p>
	<h3>Axis</h3>
	<h4 id="axis">x=0.00 y=0.00 z=0.00</h4>
</p>

<script type="text/javascript">
function fail(msg) {
	const el = document.querySelector("#axis");
	el.textContent = "Sensor is not available.";
}

function start() {
	const el = document.querySelector("#axis");
	const options = {
		frequency: 60,
		referenceFrame: 'device'
	};
	const sensor = new Accelerometer(options);

	sensor.addEventListener('reading', () => {
		el.textContent = `x=${sensor.x} y=${sensor.y} z=${sensor.z}`;
	});

	sensor.addEventListener('error', error => {
		if (event.error.name == 'NotReadableError') {
			fail("Sensor is not available.");
		} else {
			fail(`Other error occured: ${event.error.toString()}`);
		}
	});

	sensor.start();
}

function main() {
	navigator.permissions
		.query({ name: "accelerometer" })
		.then((result) => {
			if (result.state === "granted") {
				start();
			} else {
				fail("No permissions to use AbsoluteOrientationSensor.");
			}
		});
}

window.onload = main;
</script>
</body>
</html>
